---
title: "cogsci_whQ"
author: "LEE, Seo-young"
date: "2026-01-18"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(lme4)
library(lmerTest)
```


```{r data processing}
#######Splitting into exp1 and exp2########
dat_exp1 <-
  list.files(path = "./sample_data/", #later change to 'experiment_data'
             pattern = "\\.csv$",
             full.names = T) %>%
  map_df(~read_csv(., col_types = cols(.default = "c"))) %>%
  filter(exp_version == "exp1") %>%
  select(trial_type, base_rate, raw_response, trial_id, goal_condition, decision_structure)
  


dat_exp2 <-
  list.files(path = "./sample_data/", #later change to 'experiment_data'
             pattern = "\\.csv$",
             full.names = T) %>%
  map_df(~read_csv(., col_types = cols(.default = "c"))) %>%
  filter(exp_version == "exp2") %>%
  select(trial_type, response, trial_id, base_rate, goal_condition, decision_structure, chose_which_contaminated, chose_which_uncontaminated, chosen_question)




#########response coding in exp1##############
dat_exp1<-
  dat_exp1 %>% 
  mutate(response_lowercase = tolower(raw_response)) %>%
  mutate(chose_which_contaminated = 
           (grepl("contaminated", response_lowercase, fixed = TRUE) 
            & !grepl("not contaminated", response_lowercase, fixed = TRUE) 
            & !grepl("uncontaminated", response_lowercase, fixed = TRUE)) 
         | (grepl("poison", response_lowercase, fixed = TRUE) 
            & !grepl("not poison", response_lowercase, fixed = TRUE))
         | (grepl("dirty", response_lowercase, fixed = TRUE) 
            & !grepl("not dirty", response_lowercase, fixed = TRUE))
         | (grepl("dangerous", response_lowercase, fixed = TRUE) 
            & !grepl("not dangerous", response_lowercase, fixed = TRUE))
         | grepl("unsafe", response_lowercase, fixed = TRUE)
         | grepl("unclean", response_lowercase, fixed = TRUE)
         | grepl("not safe", response_lowercase, fixed = TRUE)
         | grepl("not clean", response_lowercase, fixed = TRUE),
         chose_which_uncontaminated = 
           grepl("uncontaminated", response_lowercase, fixed = TRUE)
         | grepl("not contaminated", response_lowercase, fixed = TRUE)
         | grepl("not poison", response_lowercase, fixed = TRUE)
         | grepl("not dirty", response_lowercase, fixed = TRUE)
         | grepl("not dangerous", response_lowercase, fixed = TRUE)
         | (grepl("safe", response_lowercase, fixed = TRUE) 
            & !grepl("unsafe", response_lowercase, fixed = TRUE)
            & !grepl("not safe", response_lowercase, fixed = TRUE))
         | (grepl("clean", response_lowercase, fixed = TRUE) 
            & !grepl("not clean", response_lowercase, fixed = TRUE)
            & !grepl("unclean", response_lowercase, fixed = TRUE)))
  

dat_exp1_toCode <- 
  dat_exp1%>%
  filter(chose_which_contaminated == chose_which_uncontaminated)

#check if the above transformation does binary classification
#WANT: TRUE
nrow(dat_exp1[dat_exp1$chose_which_contaminated != dat_exp1$chose_which_uncontaminated, ]) == nrow(dat_exp1) 
```



```{r}
# if nrow(dat_exp1[dat_exp1$chose_which_contaminated != dat_exp1$chose_which_uncontaminated, ]) == nrow(dat_exp1) 


```






